'use strict';

var cheerio = require('cheerio');
var request = require('request');

var getDCUSUEvents = function getDCUSUEvents(callback) {

    request('http://www.dcusu.ie/whatson/2016-10', function (error, response, html) 
    {
        if (!error && response.statusCode == 200) 
        {   
            var $ = cheerio.load(html);
            $('span.timePlace').each(function(i, element)
            {

                var time = $(this).text();
                var date = $(this).parent().text();
                var name = $(this).parent().next().next().text();

                var result = name + ' : ' + date + ', ' + time;
                callback(error, result);
            });
        }
        else{
            callback(error);
        }
    });
};

module.exports = getDCUSUEvents;
